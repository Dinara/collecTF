{% extends "base.html" %}

{% block content %}
{% load utils %}


<ul class="nav nav-tabs">
  <li class="active"><a href="#global" data-toggle="tab">Global statistics</a></li>
  <li><a href="#curation" data-toggle="tab">Curation statistics</a></li>
  <li><a href="#site" data-toggle="tab">Site statistics</a></li>
</ul>

<div class="tab-content span12">
  <div class="tab-pane active" id="global">
    <h3>CollecTF metadata</h3>
    <ul>
      <li>Number of TFs: {{ num_TFs }}</li>
      <li>Number of species: {{ num_species }}</li>
      <li>Number of curations: {{ num_curations }}</li>
      <li>Number of binding sites: {{ num_sites }}</li>
      <li>Number of publications: {{ num_publications }} ({{pub_completed}}% completed)</li>
    </ul>
  </div>
  
  <div class="tab-pane" id="curation">
    <div id="num_curations_div" class="span11"></div>
  </div>
  
  <div class="tab-pane" id="site">
    <div id="num_sites_div" class="span12"></div>
  </div>
</div>
</script>
<script type="text/javascript">

google.load("visualization", "1", {packages:["corechart"]});
google.setOnLoadCallback(drawChart);
google.setOnLoadCallback(drawChart2);
function drawChart() {
    var data = google.visualization.arrayToDataTable([
	['species', {% for tf in TFs %} '{{ tf }}', {% endfor %}],
	{% for sp in species %}
	['{{ sp }}', {% for tf in TFs %} {{ num_curations_by_TF_species|get_item:tf|get_item:sp }}, {% endfor %}],
	{% endfor %}
    ]);
    var options = {
        title: 'CollecTF curation number by TF and species',
        vAxis: {title: 'Species'},
	hAxis: {title: 'Number of curations'},
	//height: 1500, 
        chartArea: {height:"90%"},
	isStacked: true,
    };
    var chart = new google.visualization.BarChart(document.getElementById('num_curations_div'));
    chart.draw(data, options);
}

function drawChart2() {
    var data = google.visualization.arrayToDataTable([
	['species', {% for tf in TFs %} '{{ tf }}', {% endfor %}],
	{% for sp in species %}
	['{{ sp }}', {% for tf in TFs %} {{ num_sites_by_TF_species|get_item:tf|get_item:sp }}, {% endfor %}],
	{% endfor %}
    ]);
    var options = {
	title: 'CollecTF reported TFBS by TF and species',
	vAxis: {title: 'Species'},
	hAxis: {title: 'Number of sites'},
	//height: 1500, width: 
        chartArea: {height:"90%"},
	isStacked: true,
    };
    var chart = new google.visualization.BarChart(document.getElementById('num_sites_div'));
    chart.draw(data, options);
}
 
</script>
{% endblock %}
